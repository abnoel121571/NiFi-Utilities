# Apache NiFi Optimized Configuration for Oracle to Azure Data Lake Transfer
# Performance-tuned nifi.properties for Azure VM deployment

#############################################
# Core Properties
#############################################
nifi.version=${project.version}
nifi.flow.configuration.file=./conf/flow.xml.gz
nifi.flow.configuration.json.file=./conf/flow.json.gz
nifi.flow.configuration.archive.enabled=true
nifi.flow.configuration.archive.dir=./conf/archive/
nifi.flow.configuration.archive.max.time=30 days
nifi.flow.configuration.archive.max.storage=500 MB
nifi.flow.configuration.archive.max.count=

#############################################
# FlowFile Repository - Performance Optimized
#############################################
nifi.flowfile.repository.implementation=org.apache.nifi.controller.repository.WriteAheadFlowFileRepository
nifi.flowfile.repository.wal.implementation=org.apache.nifi.wali.SequentialAccessWriteAheadLog
nifi.flowfile.repository.directory=./flowfile_repository
nifi.flowfile.repository.checkpoint.interval=20 secs
nifi.flowfile.repository.always.sync=false
nifi.flowfile.repository.encryption.key.provider.implementation=
nifi.flowfile.repository.encryption.key.provider.location=
nifi.flowfile.repository.encryption.key.id=
nifi.flowfile.repository.encryption.key=

# WAL Implementation Settings for Performance
nifi.flowfile.repository.wal.rollover.size=100 MB
nifi.flowfile.repository.wal.rollover.timeout=5 mins
nifi.flowfile.repository.wal.rollover.count=50000

#############################################
# Content Repository - Optimized for Large Files
#############################################
nifi.content.repository.implementation=org.apache.nifi.controller.repository.FileSystemRepository
nifi.content.claim.max.appendable.size=50 MB
nifi.content.repository.encryption.key.provider.implementation=
nifi.content.repository.encryption.key.provider.location=
nifi.content.repository.encryption.key.id=
nifi.content.repository.encryption.key=

# Content Repository Directories (use multiple for better I/O distribution)
nifi.content.repository.directory.default=./content_repository
# Uncomment for multiple repositories on separate disks for better performance
# nifi.content.repository.directory.content1=/data/nifi/content_repository_1
# nifi.content.repository.directory.content2=/data/nifi/content_repository_2

nifi.content.repository.archive.max.retention.period=7 days
nifi.content.repository.archive.max.usage.percentage=80%
nifi.content.repository.archive.enabled=true
nifi.content.repository.always.sync=false

#############################################
# Provenance Repository - Optimized
#############################################
nifi.provenance.repository.implementation=org.apache.nifi.provenance.WriteAheadProvenanceRepository
nifi.provenance.repository.debug.frequency=1_000_000
nifi.provenance.repository.encryption.key.provider.implementation=
nifi.provenance.repository.encryption.key.provider.location=
nifi.provenance.repository.encryption.key.id=
nifi.provenance.repository.encryption.key=

# Provenance Repository Directories
nifi.provenance.repository.directory.default=./provenance_repository

# Provenance Settings for Performance
nifi.provenance.repository.max.storage.time=30 days
nifi.provenance.repository.max.storage.size=50 GB
nifi.provenance.repository.rollover.time=10 mins
nifi.provenance.repository.rollover.size=1 GB
nifi.provenance.repository.query.threads=4
nifi.provenance.repository.index.threads=4
nifi.provenance.repository.compress.on.rollover=true
nifi.provenance.repository.always.sync=false
nifi.provenance.repository.journal.count=32
nifi.provenance.repository.indexed.fields=EventType, FlowFileUUID, Filename, ProcessorID, Relationship
nifi.provenance.repository.indexed.attributes=
nifi.provenance.repository.index.shard.size=8 GB
nifi.provenance.repository.max.attribute.length=65536
nifi.provenance.repository.concurrent.merge.threads=4

#############################################
# Volatile Provenance Repository (Alternative for Better Performance)
#############################################
# nifi.provenance.repository.implementation=org.apache.nifi.provenance.VolatileProvenanceRepository
# nifi.provenance.repository.buffer.size=100000

#############################################
# Component and Node Status Repository
#############################################
nifi.components.status.repository.implementation=org.apache.nifi.controller.status.history.VolatileComponentStatusRepository
nifi.components.status.repository.buffer.size=1440
nifi.components.status.snapshot.frequency=5 mins

nifi.node.status.repository.implementation=org.apache.nifi.controller.status.history.VolatileNodeStatusRepository
nifi.node.status.repository.questdb.persist.node.status=true
nifi.node.status.repository.questdb.persist.component.status=true
nifi.node.status.repository.buffer.size=1440
nifi.node.status.snapshot.frequency=5 mins

#############################################
# Security Properties - Production Ready
#############################################
nifi.sensitive.props.key=
nifi.sensitive.props.key.protected=
nifi.sensitive.props.algorithm=NIFI_PBKDF2_AES_GCM_256
nifi.sensitive.props.additional.keys=

nifi.security.autoreload.enabled=false
nifi.security.autoreload.interval=10 secs
nifi.security.keystore=./conf/keystore.jks
nifi.security.keystoreType=JKS
nifi.security.keystorePasswd=
nifi.security.keyPasswd=
nifi.security.truststore=./conf/truststore.jks
nifi.security.truststoreType=JKS
nifi.security.truststorePasswd=
nifi.security.needClientAuth=false
nifi.security.user.authorizer=single-user-authorizer
nifi.security.allow.anonymous.authentication=false
nifi.security.user.login.identity.provider=single-user-provider
nifi.security.user.jws.key.rotation.period=PT1H
nifi.security.user.knox.url=
nifi.security.user.knox.publicKey=
nifi.security.user.knox.cookieName=hadoop-jwt
nifi.security.user.knox.audiences=

# LDAP Authentication (uncomment if using LDAP)
# nifi.security.user.login.identity.provider=ldap-provider

#############################################
# OpenId Connect SSO Properties
#############################################
nifi.security.user.oidc.discovery.url=
nifi.security.user.oidc.connect.timeout=5 secs
nifi.security.user.oidc.read.timeout=5 secs
nifi.security.user.oidc.client.id=
nifi.security.user.oidc.client.secret=
nifi.security.user.oidc.preferred.jwsalgorithm=
nifi.security.user.oidc.additional.scopes=
nifi.security.user.oidc.claim.identifying.user=
nifi.security.user.oidc.fallback.claims.identifying.user=

#############################################
# Apache Knox SSO Properties
#############################################
nifi.security.user.knox.url=
nifi.security.user.knox.publicKey=
nifi.security.user.knox.cookieName=hadoop-jwt
nifi.security.user.knox.audiences=

#############################################
# Web Properties - Performance Tuned
#############################################
nifi.web.http.host=0.0.0.0
nifi.web.http.port=8080
nifi.web.http.network.interface.default=

# Enable HTTPS for production
nifi.web.https.host=0.0.0.0
nifi.web.https.port=8443
nifi.web.https.network.interface.default=

# Web UI Performance
nifi.web.max.header.size=16 KB
nifi.web.jetty.working.directory=./work/jetty
nifi.web.jetty.threads=200
nifi.web.max.requests.per.second=30000
nifi.web.max.access.token.requests.per.second=25
nifi.web.request.timeout=60 secs
nifi.web.request.ip.whitelist=
nifi.web.should.send.server.version=true
nifi.web.request.log.format=%{client}a - %u %t "%r" %s %O "%{Referer}i" "%{User-Agent}i"

#############################################
# Remote Input Port - Cluster Communication
#############################################
nifi.remote.input.host=
nifi.remote.input.secure=false
nifi.remote.input.socket.port=10000
nifi.remote.input.http.enabled=true
nifi.remote.input.http.transaction.ttl=30 secs
nifi.remote.contents.cache.expiration=30 secs

#############################################
# Cluster Configuration - Production Settings
#############################################
nifi.cluster.is.node=false
nifi.cluster.node.address=
nifi.cluster.node.protocol.port=11443
nifi.cluster.node.protocol.max.threads=50
nifi.cluster.node.event.history.size=25
nifi.cluster.node.connection.timeout=5 secs
nifi.cluster.node.read.timeout=5 secs
nifi.cluster.node.max.concurrent.requests=100
nifi.cluster.firewall.file=
nifi.cluster.flow.election.max.wait.time=5 mins
nifi.cluster.flow.election.max.candidates=

# Cluster Load Balancing
nifi.cluster.load.balance.host=
nifi.cluster.load.balance.port=6342
nifi.cluster.load.balance.connections.per.node=4
nifi.cluster.load.balance.max.thread.count=8
nifi.cluster.load.balance.comms.timeout=30 secs

#############################################
# ZooKeeper Properties (if clustering enabled)
#############################################
nifi.zookeeper.connect.string=
nifi.zookeeper.connect.timeout=10 secs
nifi.zookeeper.session.timeout=10 secs
nifi.zookeeper.root.node=/nifi
nifi.zookeeper.client.secure=false
nifi.zookeeper.security.keystore=
nifi.zookeeper.security.keystoreType=
nifi.zookeeper.security.keystorePasswd=
nifi.zookeeper.security.truststore=
nifi.zookeeper.security.truststoreType=
nifi.zookeeper.security.truststorePasswd=

#############################################
# Kerberos Configuration
#############################################
nifi.kerberos.krb5.file=
nifi.kerberos.service.principal=
nifi.kerberos.service.keytab.location=
nifi.kerberos.spnego.principal=
nifi.kerberos.spnego.keytab.location=
nifi.kerberos.spnego.authentication.expiration=12 hours

#############################################
# Custom Properties for Oracle to Azure Migration
#############################################

# Oracle Database Connection Optimization
nifi.oracle.connection.pool.max.total=25
nifi.oracle.connection.pool.max.idle=15
nifi.oracle.connection.pool.min.idle=5
nifi.oracle.fetch.size=50000
nifi.oracle.connection.timeout=30000
nifi.oracle.read.timeout=60000

# Azure Storage Optimization
nifi.azure.block.size.default=16MB
nifi.azure.buffer.size.default=4MB
nifi.azure.retry.count=5
nifi.azure.timeout=300

# Performance Monitoring
nifi.performance.monitoring.enabled=true
nifi.performance.monitoring.frequency=30 secs

# Memory Management for Large Data Sets
nifi.content.viewer.url=../nifi-content-viewer/
nifi.ui.banner.text=Oracle to Azure Data Migration - Production
nifi.ui.autorefresh.interval=30 sec

# Flow File Processing Limits
nifi.queue.backpressure.count=50000
nifi.queue.backpressure.size=10 GB

# Administrative Yield Duration
nifi.administrative.yield.duration=30 sec

# Bored Yield Duration
nifi.bored.yield.duration=10 millis

# Notification Services
nifi.notification.services.file=./conf/notification-services.xml

# Variable Registry
nifi.variable.registry.properties=./conf/custom.properties

#############################################
# Status History - Memory Efficient
#############################################
nifi.components.status.repository.buffer.size=1440
nifi.components.status.snapshot.frequency=5 mins

#############################################
# Additional Performance Settings
#############################################

# Flow Configuration Processing
nifi.flow.configuration.archive.max.count=100
nifi.flow.configuration.archive.max.time=30 days
nifi.flow.configuration.archive.max.storage=500 MB

# Swap Management
nifi.swap.manager.implementation=org.apache.nifi.controller.FileSystemSwapManager
nifi.queue.swap.threshold=20000
nifi.swap.in.period=5 sec
nifi.swap.in.threads=4
nifi.swap.out.period=5 sec
nifi.swap.out.threads=4

# Content Claim Management
nifi.content.claim.max.flow.files=100
nifi.content.claim.max.appendable.size=50 MB

#############################################
# Analytics Properties
#############################################
nifi.analytics.predict.enabled=false
nifi.analytics.predict.interval=3 mins
nifi.analytics.query.interval=5 mins
nifi.analytics.connection.model.implementation=org.apache.nifi.controller.status.analytics.models.OrdinaryLeastSquares
nifi.analytics.connection.model.score.name=rSquared
nifi.analytics.connection.model.score.threshold=.90

#############################################
# NAR Provider Properties
#############################################
nifi.nar.library.provider.implementation=org.apache.nifi.nar.StandardNarProvider
nifi.nar.library.directory=./lib
nifi.nar.working.directory=./work/nar/
nifi.nar.library.autoload.directory=./extensions
nifi.nar.library.conflict.resolution=IGNORE

#############################################
# Extension Directories
#############################################
nifi.nar.library.directory.custom=./custom_nars
